#### 记一次生产事故
* 事故：
  * 表现：项目自定义开发的接口一直pending. 导致前段页面无法正常加载。
* 排查过程：
  * 后端服务日志显示：自定义的Controller not found。
  * 因为之前出现过类似问题，怀疑是项目启动时没有import到自定义的Controller成功。
  * 重启服务验证（启动服务会有专门的函数import所有controller）。项目报错：
```javascript
  UnhandledPromiseRejectionWarning: /egova/srv/ts/ts_custom/node_modules/minimatch/dist/commonjs/ast.js:86
    #fillNegs() {
             ^
SyntaxError: Unexpected token '('  
```
  * 经过搜索得知是因为node版本过低（14.2.0）导致的。因为minimatch在v5.0.0版本开始使用了ES6的语法。    

* 解决方法：有2个
  * 升级node版本到v16.0.0以上。❌ 
  * 将minimatch降级到v4.0.4版本 ✅

* 原因：
    * 表面原因：自定义的Controller继承了基础类，基础类使用了minimatch库的v5.0.0版本。
    * 根本原因：
        * minimatch被很多其他库依赖。（*npm ls minimatch*可以看被哪些包依赖）
        * package-lock.json中minimatch的版本是v5.0.0。所以在安装依赖时会自动安装v5.0.0版本。
    
* 经验教训：
    * 开发环境的node版本要和生产环境一致。
    * 开发环境的package-lock.json要和生产环境一致。